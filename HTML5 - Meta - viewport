<h1>HTML5 - Meta - viewport</h1>

<p>2013-12-05 23:28 Thursday</p>

<h3>什么是Viewport视区概念</h3>

<p>用 HTML5&nbsp;开发移动应用时往往会遇到手机的分辨率或屏幕大小不同的问题，如何使我们开发出来的应用或页面大小能适合各种手机呢？HTML5 中的 viewport 能帮你做到。</p>

<p>手机浏览器是把页面放在一个虚拟的&ldquo;窗口&rdquo;(viewport)中，通常这个虚拟的&ldquo;窗口&rdquo;(viewport)比屏幕宽，这样就不用把每个网页挤到很小的窗口中(这样会破坏没有针对手机浏览器优化的网页的布局)，用户可以通过平移和缩放来看网页的不同部分。移动版的 Safari 浏览器最新引进了 viewport 这个 meta tag，让网页开发者来控制 viewport 的大小和缩放，其他手机浏览器也基本支持。</p>

<p>此外，在开发地图应用的时候，也需要使用到Viewport，整张地图往往比屏幕宽很多。</p>

<h3>Viewport基础语法介绍</h3>

<p>一个常用的针对移动网页优化过的页面的 viewport meta 标签大致如下：</p>

<pre>
&lt;meta name=&rdquo;viewport&rdquo; content=&rdquo;width=device-width, initial-scale=1, maximum-scale=1&Prime;&gt;</pre>

<p>Viewport 的常用参数如下</p>

<pre>
&lt;meta name=&rdquo;viewport&rdquo;
content=&rdquo;
height = [pixel_value | device-height] ,
width = [pixel_value | device-width ] ,
initial-scale = float_value ,
minimum-scale = float_value ,
maximum-scale = float_value ,
user-scalable = [yes | no] ,
target-densitydpi = [dpi_value | device-dpi | high-dpi | medium-dpi | low-dpi]
/&gt;</pre>

<p>width：</p>

<p>控制 viewport 的大小，可以指定的一个值，如果 600，或者特殊的值，如 device-width 为设备的宽度(单位为缩放为 100% 时的 CSS 的像素)。</p>

<p>height：</p>

<p>和 width 相对应，指定高度。</p>

<p>initial-scale：</p>

<p>初始缩放比例，也即是当页面第一次 load 的时候缩放比例。这是一个浮点值，是页面大小的一个乘数。例如，如果你设置初始缩放为&ldquo;1.0&rdquo;，那么，web页面在展现的时候就会以target density分辨率的1:1来展现。如果你设置为&ldquo;2.0&rdquo;，那么这个页面就会放大为2倍。</p>

<p>maximum-scale：</p>

<p>允许用户缩放到的最大比例。这也是一个浮点值，用以指出页面大小与屏幕大小相比的最大乘数。例如，如果你将这个值设置为&ldquo;2.0&rdquo;，那么这个页面与target size相比，最多能放大2倍。</p>

<p>minimum-scale：</p>

<p>允许用户缩放到的最小比例。</p>

<p>user-scalable：</p>

<p>用户是否可以手动缩放，如果设置为yes则是允许用户对其进行改变，反之为no。默认值是yes。</p>

<p>所有的缩放值都必须在0.01&ndash;10的范围之内。</p>

<p>例：</p>

<p>1.设置屏幕宽度为设备宽度，禁止用户手动调整缩放；</p>

<p>2.设置屏幕密度为高频，中频，低频自动缩放，禁止用户手动调整缩放。</p>

<p>maximum-scale都将被忽略，因为根本不可能缩放。</p>

<p>target-densitydpi：</p>

<p>一个屏幕像素密度是由屏幕分辨率决定的，通常定义为每英寸点的数量(dpi)。Android支持三种屏幕像素密度：低像素密度，中像素密度，高像素密度。一个低像素密度的屏幕每英寸上的像素点更少，而一个高像素密度的屏幕每英寸上的像素点更多。Android Browser和WebView默认屏幕为中像素密度。</p>

<p>target-densitydpi 属性的取值范围</p>

<ul>
	<li>device-dpi:&nbsp;使用设备原本的 dpi 作为目标 dp。 不会发生默认缩放。</li>
	<li>high-dpi:&nbsp;使用hdpi 作为目标 dpi。 中等像素密度和低像素密度设备相应缩小。</li>
	<li>medium-dpi:&nbsp;使用mdpi作为目标 dpi。 高像素密度设备相应放大， 像素密度设备相应缩小。这是默认的target density。</li>
	<li>low-dpi:&nbsp;使用mdpi作为目标 dpi。中等像素密度和高像素密度设备相应放大。</li>
	<li>&lt;value&gt;:&nbsp;指定一个具体的dpi 值作为target dpi. 这个值的范围必须在70&ndash;400之间。</li>
</ul>

<pre>
&lt;meta name=&rdquo;viewport&rdquo; content=&rdquo;target-densitydpi=device-dpi&rdquo; /&gt;
&lt;meta name=&rdquo;viewport&rdquo; content=&rdquo;target-densitydpi=high-dpi&rdquo; /&gt;
&lt;meta name=&rdquo;viewport&rdquo; content=&rdquo;target-densitydpi=medium-dpi&rdquo; /&gt;
&lt;meta name=&rdquo;viewport&rdquo; content=&rdquo;target-densitydpi=low-dpi&rdquo; /&gt;
&lt;meta name=&rdquo;viewport&rdquo; content=&rdquo;target-densitydpi=200&Prime; /&gt;</pre>

<p>为了防止Android Browser和WebView 根据不同屏幕的像素密度对你的页面进行缩放，你可以将viewport的target-densitydpi 设置为 device-dpi。当你这么做了，页面将不会缩放。相反，页面会根据当前屏幕的像素密度进行展示。在这种情形下，你还需要将viewport的width定义为与设备的width匹配，这样你的页面就可以和屏幕相适应。</p>

<h4>Viewport 参考资料</h4>

<ul>
	<li>Mozilla 开发者博客&nbsp;<a href="https://developer.mozilla.org/en/Mobile/Viewport_meta_tag" target="_blank">viewport 使用教程</a>。</li>
	<li>Apple 开发者站&nbsp;<a href="http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html" target="_blank">viewport 详细的描述</a>。</li>
	<li>quirksmode.org&nbsp;<a href="http://www.quirksmode.org/mobile/viewports2.html" target="_blank">viewport 在各个手机浏览器不同之处介绍</a>。</li>
</ul>
